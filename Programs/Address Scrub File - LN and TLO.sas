/*ADDRESS SCRUB FILE*/

/*GET LN DATA AND ACCOUNT ID TO IT*/
PROC SQL;
   CREATE TABLE LN_ADDRESS_SCRUB_PRE AS 
   SELECT T2.ACCOUNTID, 
          T1.ACCOUNT_NUMBER, 
          T1.UNIQUE_NUMBER, 
          T1.CLIENT_CODE, 
          T1.CLIENT_INPUT_SSN, 
          T1.CLIENT_FIRST_NAME, 
          T1.CLIENT_LAST_NAME, 
          T1.BKR_FLAG, 
          T1.CASE_NUMBER, 
          T1.CHAPTER, 
          T1.FILE_DATE, 
          T1.STATUS_DATE, 
          T1.DISPOSITION_CODE, 
          T1.SUFFIX, 
          T1.ADDRESS, 
          T1.ZIP_CODE, 
          T1.SOCIAL_SECURITY_NUMBER, 
          T1.CITY_FILED, 
          T1.STATE_FILED, 
          T1.COUNTY, 
          T1.FIRST_NAME, 
          T1.MIDDLE_NAME, 
          T1.LAST_NAME, 
          T1.BUSINESS, 
          T1.BUSINESS_1, 
          T1.BUSINESS_2, 
          T1.BUSINESS_3, 
          T1.DEBTOR_S_CITY, 
          T1.DEBTOR_S_STATE, 
          T1.ECOA, 
          T1.LAW_FIRM, 
          T1.ATTORNEY_NAME, 
          T1.ATTORNEY_ADDRESS, 
          T1.ATTORNEY_CITY, 
          T1.ATTORNEY_STATE, 
          T1.ATTORNEY_ZIP, 
          T1.ATTORNEY_PHONE, 
          T1.ATTORNEY_EMAIL, 
          T1.ATTORNEY_FAX, 
          T1._341_DATE, 
          T1._341_TIME, 
          T1._341_LOCATION, 
          T1.TRUSTEE, 
          T1.TRUSTEE_ADDRESS, 
          T1.TRUSTEE_CITY, 
          T1.TRUSTEE_STATE, 
          T1.TRUSTEE_ZIP, 
          T1.TRUSTEE_PHONE, 
          T1.JUDGE_S_INITIALS, 
          T1.FUNDS, 
          T1.DISCHARGE_COMPLAINT_BAR_DATE, 
          T1.MATCH_CODE, 
          T1.COURT_DISTRICT, 
          T1.COURT_ADDRESS_1, 
          T1.COURT_ADDRESS_2, 
          T1.COURT_MAILING_CITY, 
          T1.COURT_ZIP, 
          T1.COURT_PHONE, 
          T1.DEBTOR_PHONE, 
          T1.VOLUNTARY_INVOLUNTARY_DISMISSAL, 
          T1.PROOF_OF_CLAIM_DATE, 
          T1.MULTIPLE_DEBTOR, 
          T1.COURT_ID, 
          T1.TRUSTEE_ID, 
          T1.REINSTATED_CASE_DATE, 
          T1.CLOSED_DATE, 
          T1.CLIENT_UPDATE_FLAG, 
          T1.FILING_STATUS, 
          T1.DEC_SSN, 
          T1.DEC_FNAME, 
          T1.DEC_MNAME, 
          T1.DEC_LNAME, 
          T1.DEC_SUFFIX, 
          T1.DEC_ADDRESS, 
          T1.DEC_CITY, 
          T1.DEC_STATE, 
          T1.DEC_ZIP, 
          T1.DEC_COUNTY_NAME, 
          T1.DEC_BDATE, 
          T1.DEC_DDATE, 
          T1.DEC_MATCHCODE, 
          T1.DEC_SOURCE, 
          T1.LITIGIOUSDEBTOR_FLAG, 
          T1.NAME_FIRST_1, 
          T1.NAME_MIDDLE_1, 
          T1.NAME_LAST_1, 
          T1.NAME_SUFFIX_1, 
          T1.ADDRESS_1, 
          T1.P_CITY_NAME_1, 
          T1.ST_1, 
          T1.ZIP_1, 
          T1.ADDR_DT_FIRST_SEEN_1, 
          T1.ADDR_DT_LAST_SEEN_1, 
          T1.CONF_ADDR_MATCH_CODE_1, 
          T1.SUBJ_FIRST_1, 
          T1.SUBJ_MIDDLE_1, 
          T1.SUBJ_LAST_1, 
          T1.SUBJ_SUFFIX_1, 
          T1.SUBJ_PHONE_MATCH_FLAG_1, 
          T1.SUBJ_PHONE_1, 
          T1.SUBJ_PHONE_LISTING_NAME_1, 
          T1.SUBJ_PHONE_POSSIBLE_RELATIONSHIP, 
          T1.SUBJ_PHONE_LINE_TYPE_1, 
          T1.SUBJ_FIRST_2, 
          T1.SUBJ_MIDDLE_2, 
          T1.SUBJ_LAST_2, 
          T1.SUBJ_SUFFIX_2, 
          T1.SUBJ_PHONE_MATCH_FLAG_2, 
          T1.SUBJ_PHONE_2, 
          T1.SUBJ_PHONE_LISTING_NAME_2, 
          T1.SUBJ_PHONE_POSSIBLE_RELATIO_0001, 
          T1.SUBJ_PHONE_LINE_TYPE_2, 
          T1.SUBJ_FIRST_3, 
          T1.SUBJ_MIDDLE_3, 
          T1.SUBJ_LAST_3, 
          T1.SUBJ_SUFFIX_3, 
          T1.SUBJ_PHONE_MATCH_FLAG_3, 
          T1.SUBJ_PHONE_3, 
          T1.SUBJ_PHONE_LISTING_NAME_3, 
          T1.SUBJ_PHONE_POSSIBLE_RELATIO_0002, 
          T1.SUBJ_PHONE_LINE_TYPE_3, 
          T1.PAWK_1_FIRST, 
          T1.PAWK_1_MIDDLE, 
          T1.PAWK_1_LAST, 
          T1.PAWK_1_SUFFIX, 
          T1.PAWK_1_SSN, 
          T1.PAWK_1_TITLE, 
          T1.PAWK_1_FIRST_SEEN, 
          T1.PAWK_1_LAST_SEEN, 
          T1.PAWK_1_BDID, 
          T1.PAWK_1_COMPANY_NAME, 
          T1.PAWK_1_DEPARTMENT, 
          T1.PAWK_1_FEIN, 
          T1.PAWK_1_ADDRESS, 
          T1.PAWK_1_CITY, 
          T1.PAWK_1_STATE, 
          T1.PAWK_1_ZIP5, 
          T1.PAWK_1_ZIP4, 
          T1.PAWK_1_PHONE10, 
          T1.PAWK_1_VERIFIED, 
          T1.PAWK_1_EMAIL, 
          T1.PAWK_2_DID, 
          T1.PAWK_2_CONFIDENCE_LEVEL, 
          T1.PAWK_2_FIRST, 
          T1.PAWK_2_MIDDLE, 
          T1.PAWK_2_LAST, 
          T1.PAWK_2_SUFFIX, 
          T1.PAWK_2_SSN, 
          T1.PAWK_2_TITLE, 
          T1.PAWK_2_FIRST_SEEN, 
          T1.PAWK_2_LAST_SEEN, 
          T1.PAWK_2_BDID, 
          T1.PAWK_2_COMPANY_NAME, 
          T1.PAWK_2_DEPARTMENT, 
          T1.PAWK_2_FEIN, 
          T1.PAWK_2_ADDRESS, 
          T1.PAWK_2_CITY, 
          T1.PAWK_2_STATE, 
          T1.PAWK_2_ZIP5, 
          T1.PAWK_2_ZIP4, 
          T1.PAWK_2_PHONE10, 
          T1.PAWK_2_VERIFIED, 
          T1.PAWK_2_EMAIL, 
          T1.PAWK_3_DID, 
          T1.PAWK_3_CONFIDENCE_LEVEL, 
          T1.PAWK_3_FIRST, 
          T1.PAWK_3_MIDDLE, 
          T1.PAWK_3_LAST, 
          T1.PAWK_3_SUFFIX, 
          T1.PAWK_3_SSN, 
          T1.PAWK_3_TITLE, 
          T1.PAWK_3_FIRST_SEEN, 
          T1.PAWK_3_LAST_SEEN, 
          T1.PAWK_3_BDID, 
          T1.PAWK_3_COMPANY_NAME, 
          T1.PAWK_3_DEPARTMENT, 
          T1.PAWK_3_FEIN, 
          T1.PAWK_3_ADDRESS, 
          T1.PAWK_3_CITY, 
          T1.PAWK_3_STATE, 
          T1.PAWK_3_ZIP5, 
          T1.PAWK_3_ZIP4, 
          T1.PAWK_3_PHONE10, 
          T1.PAWK_3_VERIFIED, 
          T1.PAWK_3_EMAIL, 
          T1.PAWK_4_DID, 
          T1.PAWK_4_CONFIDENCE_LEVEL, 
          T1.PAWK_4_FIRST, 
          T1.PAWK_4_MIDDLE, 
          T1.PAWK_4_LAST, 
          T1.PAWK_4_SUFFIX, 
          T1.PAWK_4_SSN, 
          T1.PAWK_4_TITLE, 
          T1.PAWK_4_FIRST_SEEN, 
          T1.PAWK_4_LAST_SEEN, 
          T1.PAWK_4_BDID, 
          T1.PAWK_4_COMPANY_NAME, 
          T1.PAWK_4_DEPARTMENT, 
          T1.PAWK_4_FEIN, 
          T1.PAWK_4_ADDRESS, 
          T1.PAWK_4_CITY, 
          T1.PAWK_4_STATE, 
          T1.PAWK_4_ZIP5, 
          T1.PAWK_4_ZIP4, 
          T1.PAWK_4_PHONE10, 
          T1.PAWK_4_VERIFIED, 
          T1.PAWK_4_EMAIL, 
          T1.PAWK_5_DID, 
          T1.PAWK_5_CONFIDENCE_LEVEL, 
          T1.PAWK_5_FIRST, 
          T1.PAWK_5_MIDDLE, 
          T1.PAWK_5_LAST, 
          T1.PAWK_5_SUFFIX, 
          T1.PAWK_5_SSN, 
          T1.PAWK_5_TITLE, 
          T1.PAWK_5_FIRST_SEEN, 
          T1.PAWK_5_LAST_SEEN, 
          T1.PAWK_5_BDID, 
          T1.PAWK_5_COMPANY_NAME, 
          T1.PAWK_5_DEPARTMENT, 
          T1.PAWK_5_FEIN, 
          T1.PAWK_5_ADDRESS, 
          T1.PAWK_5_CITY, 
          T1.PAWK_5_STATE, 
          T1.PAWK_5_ZIP5, 
          T1.PAWK_5_ZIP4, 
          T1.PAWK_5_PHONE10, 
          T1.PAWK_5_VERIFIED, 
          T1.PAWK_5_EMAIL
      FROM LN_OUTPUT_LNWATERFALL_INPUT_EBG T1
      INNER JOIN BEAM_ACCT_EXTRACT T2 
		ON (COMPRESS(T1.ACCOUNT_NUMBER) = COMPRESS(T2.ISSUERACCOUNTNUMBER));
QUIT;


/*GET TILO AND ADD ACCOUNT*/

PROC SQL;
   CREATE TABLE TLO_WATERFALL_ADDRESS_SCRUB AS 
   SELECT T2.ACCOUNTID,
		  T1.CUSTOMER_ACCOUNT, 
          T1.FIRST_NAME, 
          T1.MIDDLE_NAME, 
          T1.LAST_NAME, 
          T1.SUFFIX, 
          T1.SSN, 
          T1.ADDRESS_1, 
          T1.ADDRESS_2, 
          T1.CITY, 
          T1.STATE, 
          T1.ZIP, 
          T1.TLODATEOFDEATH, 
          T1.TLOBANKRUPTCYMATCHCODES, 
          T1.TLOBANKRUPTCYCHAPTER, 
          T1.TLOBANKRUPTCYDEBTORNAME, 
          T1.TLOBANKRUPTCYCASENUMBER, 
          T1.TLOBANKRUPTCYFILEDATE, 
          T1.TLOBANKRUPTCYDISCHARGEDATE, 
          T1.TLOBANKRUPTCYCLOSEDDATE, 
          T1.TLOBANKRUPTCYNOTICETYPE, 
          T1.TLOBANKRUPTCYATTORNEYNAME, 
          T1.TLOBANKRUPTCYATTORNEYADDRESS, 
          T1.TLOBANKRUPTCYATTORNEYADDRESSLINE, 
          T1.TLOBANKRUPTCYATTORNEYADDRES_0001, 
          T1.TLOBANKRUPTCYATTORNEYADDRES_0002, 
          T1.TLOBANKRUPTCYATTORNEYADDRESSCITY, 
          T1.TLOBANKRUPTCYATTORNEYADDRESSSTAT, 
          T1.TLOBANKRUPTCYATTORNEYADDRESSZIP, 
          T1.TLOBANKRUPTCYATTORNEYADDRESSZIP4, 
          T1.TLOBANKRUPTCYATTORNEYPHONE, 
          T1.TLOBANKRUPTCYCOURTDISTRICT, 
          T1.TLOBANKRUPTCYCOURTDIVISION, 
          T1.TLOBANKRUPTCYCOURTADDRESS, 
          T1.TLOBANKRUPTCYCOURTADDRESSLINE1, 
          T1.TLOBANKRUPTCYCOURTADDRESSLINE2, 
          T1.TLOBANKRUPTCYCOURTADDRESSLINE3, 
          T1.TLOBANKRUPTCYCOURTADDRESSCITY, 
          T1.TLOBANKRUPTCYCOURTADDRESSSTATE, 
          T1.TLOBANKRUPTCYCOURTADDRESSZIP, 
          T1.TLOBANKRUPTCYCOURTADDRESSZIP4, 
          T1.TLOBANKRUPTCYCOURTPHONE, 
          T1.TLOBANKRUPTCYTRUSTEENAME, 
          T1.TLOBANKRUPTCYTRUSTEEADDRESS, 
          T1.TLOBANKRUPTCYTRUSTEEADDRESSLINE1, 
          T1.TLOBANKRUPTCYTRUSTEEADDRESSLINE2, 
          T1.TLOBANKRUPTCYTRUSTEEADDRESSLINE3, 
          T1.TLOBANKRUPTCYTRUSTEEADDRESSCITY, 
          T1.TLOBANKRUPTCYTRUSTEEADDRESSSTATE, 
          T1.TLOBANKRUPTCYTRUSTEEADDRESSZIP, 
          T1.TLOBANKRUPTCYTRUSTEEADDRESSZIP4, 
          T1.TLOBANKRUPTCYTRUSTEEPHONE, 
          T1.TLOBANKRUPTCYDISMISSEDDATE, 
          T1.TLOBANKRUPTCYTRANSFERREDDATE, 
          T1.TLOBANKRUPTCYPLACEHOLDER, 
          T1.TLOBANKRUPTCYPRIMARYDEBTORFULLNA, 
          T1.TLOBANKRUPTCYPRIMARYDEBTORFIRSTN, 
          T1.TLOBANKRUPTCYPRIMARYDEBTORLASTNA, 
          T1.TLOBANKRUPTCYPRIMARYDEBTORMIDDLE, 
          T1.TLOBANKRUPTCYPRIMARYDEBTORNAMESU, 
          T1.TLOBANKRUPTCYPRIMARYDEBTORFULLAD, 
          T1.TLOBANKRUPTCYPRIMARYDEBTORADDRES, 
          T1.TLOBANKRUPTCYPRIMARYDEBTORA_0001, 
          T1.TLOBANKRUPTCYPRIMARYDEBTORA_0002, 
          T1.TLOBANKRUPTCYPRIMARYDEBTORA_0003, 
          T1.TLOBANKRUPTCYPRIMARYDEBTORA_0004, 
          T1.TLOBANKRUPTCYPRIMARYDEBTORA_0005, 
          T1.TLOBANKRUPTCYPRIMARYDEBTORA_0006, 
          T1.TLOBANKRUPTCYPRIMARYDEBTORPHONE, 
          T1.TLOBANKRUPTCYPRIMARYDEBTORSSN, 
          T1.TLOBANKRUPTCYPRIMARYDEBTORAKA1, 
          T1.TLOBANKRUPTCYPRIMARYDEBTORAKA2, 
          T1.TLOBANKRUPTCYSECONDARYDEBTORFULL, 
          T1.TLOBANKRUPTCYSECONDARYDEBTORFIRS, 
          T1.TLOBANKRUPTCYSECONDARYDEBTORLAST, 
          T1.TLOBANKRUPTCYSECONDARYDEBTORMIDD, 
          T1.TLOBANKRUPTCYSECONDARYDEBTORNAME, 
          T1.TLOBANKRUPTCYSECONDARYDEBTO_0001, 
          T1.TLOBANKRUPTCYSECONDARYDEBTORADDR, 
          T1.TLOBANKRUPTCYSECONDARYDEBTO_0002, 
          T1.TLOBANKRUPTCYSECONDARYDEBTO_0003, 
          T1.TLOBANKRUPTCYSECONDARYDEBTO_0004, 
          T1.TLOBANKRUPTCYSECONDARYDEBTO_0005, 
          T1.TLOBANKRUPTCYSECONDARYDEBTO_0006, 
          T1.TLOBANKRUPTCYSECONDARYDEBTO_0007, 
          T1.TLOBANKRUPTCYSECONDARYDEBTORPHON, 
          T1.TLOBANKRUPTCYSECONDARYDEBTORSSN, 
          T1.TLOBANKRUPTCYSECONDARYDEBTORAKA1, 
          T1.TLOBANKRUPTCYSECONDARYDEBTORAKA2, 
          T1.TLOBANKRUPTCYFLAG, 
          T1.TLOBANKRUPTCY341DATE, 
          T1.TLOBANKRUPTCY341TIME, 
          T1.TLOBANKRUPTCY341ADDRESSLINE1, 
          T1.TLOBANKRUPTCY341ADDRESSLINE2, 
          T1.TLOBANKRUPTCY341ADDRESSLINE3, 
          T1.TLOBANKRUPTCY341ADDRESSCITY, 
          T1.TLOBANKRUPTCY341ADDRESSSTATE, 
          T1.TLOBANKRUPTCY341ADDRESSZIP, 
          T1.TLOBANKRUPTCY341ADDRESSZIP4, 
          T1.TLOBANKRUPTCY341FULLADDRESS, 
          T1.TLOBANKRUPTCYVOLUNTARYFLAG, 
          T1.TLOBANKRUPTCYASSETSINDICATOR, 
          T1.TLOBANKRUPTCYORIGINALCHAPTER, 
          T1.TLOBANKRUPTCYCONVERTEDCHAPTER, 
          T1.TLOBANKRUPTCYUPDATEDDATE, 
          T1.TLOBANKRUPTCYTRUSTEEFIRSTNAME, 
          T1.TLOBANKRUPTCYTRUSTEEMIDDLENAME, 
          T1.TLOBANKRUPTCYTRUSTEELASTNAME, 
          T1.TLOBANKRUPTCYTRUSTEENAMESUFFIX, 
          T1.TLOBANKRUPTCYJUDGEINITIALS, 
          T1.TLOBANKRUPTCYCOURTNAME, 
          T1.TLOBANKRUPTCYATTORNEYFIRSTNAME, 
          T1.TLOBANKRUPTCYATTORNEYMIDDLENAME, 
          T1.TLOBANKRUPTCYATTORNEYLASTNAME, 
          T1.TLOBANKRUPTCYATTORNEYNAMESUFFIX, 
          T1.TLOBANKRUPTCYPROSEINDICATOR, 
          T1.TLOBANKRUPTCYLAWFIRM, 
          T1.TLOBANKRUPTCYBARDATE, 
          T1.TLOADDRESS1LINE1, 
          T1.TLOADDRESS1LINE2, 
          T1.TLOADDRESS1LINE3, 
          T1.TLOADDRESS1CITY, 
          T1.TLOADDRESS1STATE, 
          T1.TLOADDRESS1ZIP, 
          T1.TLOADDRESS1COUNTY, 
          T1.TLOADDRESS1DATEFIRSTSEEN, 
          T1.TLOADDRESS1DATELASTSEEN, 
          T1.TLOADDRESS2LINE1, 
          T1.TLOADDRESS2LINE2, 
          T1.TLOADDRESS2LINE3, 
          T1.TLOADDRESS2CITY, 
          T1.TLOADDRESS2STATE, 
          T1.TLOADDRESS2ZIP, 
          T1.TLOADDRESS2COUNTY, 
          T1.TLOADDRESS2DATEFIRSTSEEN, 
          T1.TLOADDRESS2DATELASTSEEN, 
          T1.TLOPHONE1, 
          T1.TLOPHONE1PHONETYPE, 
          T1.TLOPHONE1SCORE, 
          T1.TLOPHONE2, 
          T1.TLOPHONE2PHONETYPE, 
          T1.TLOPHONE2SCORE, 
          T1.TLOPHONE3, 
          T1.TLOPHONE3PHONETYPE, 
          T1.TLOPHONE3SCORE, 
          T1.MATCHCODES, 
          T1.BOB_TOOMANYHITS
      FROM TLO_WATERFALL_INPUT_EBG T1
      INNER JOIN BEAM_ACCT_EXTRACT T2 
		ON (COMPRESS(T1.ACCOUNT_NUMBER) = COMPRESS(T2.ISSUERACCOUNTNUMBER));
;
QUIT;